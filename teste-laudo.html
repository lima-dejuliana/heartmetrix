<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <button onclick="gerarPdf()">Gerar PDF</button>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.4.1/jspdf.debug.js"
    integrity="sha384-THVO/sM0mFD9h7dfSndI6TS0PgAGavwKvB5hAxRRvc0o9cPLohB0wb/PTA7LdUHs"
    crossorigin="anonymous"></script>
  <script>
    function gerarPdf() {
      // Função para carregar uma imagem como base64
      const getBase64Image = (url) => {
        return new Promise((resolve, reject) => {
          const img = new Image();
          img.crossOrigin = 'Anonymous'; // Habilita o CORS, se necessário
          img.onload = () => {
            const canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0);
            const dataURL = canvas.toDataURL('image/jpeg'); // Pode mudar o formato se necessário (png, etc.)
            resolve(dataURL);
          };
          img.onerror = reject;
          img.src = url;
        });
      };

      // Cria um novo documento PDF
      const doc = new jsPDF('l', 'mm', 'a4');

      // Adiciona a imagem incorporada ao PDF
      const addEmbeddedImageToPDF = async (url, x, y, width, height) => {
        try {
          const base64Img = await getBase64Image(url);
          doc.addImage(base64Img, 'JPEG', x, y, width, height);
          addTextToPDF('Nome do paciente', 22, 92);
          doc.save('arquivo.pdf');
        } catch (error) {
          console.error('Erro ao incorporar a imagem:', error);
        }
      };

      // Adiciona texto ao PDF
      const addTextToPDF = (text, x, y) => {
        doc.text(text, x, y);
      };

      // Chamada para adicionar a imagem incorporada ao PDF
      addEmbeddedImageToPDF('http://127.0.0.1:5501/assets/images/laudo/laudo_pagina_1.jpg', 0, 0, 297, 210); // Altere o caminho da imagem
    }
  </script>
</body>

</html>